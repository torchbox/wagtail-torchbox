{% load wagtailcore_tags wagtailimages_tags staticfiles %}

{# orange arrow navigation #}
<!-- <div class="nextprev-nav">
    {% if blog_posts.has_previous %}
        <div class="nextprev prev">
            <a href="?page={{ blog_posts.previous_page_number }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&amp;{{ key }}={{ value }}{% endifnotequal %}{% endfor %}" class="previous"><span>Previous page</span></a>
        </div>
    {% endif %}
    {% if blog_posts.has_next %}
        <div class="nextprev next">
            <a href="?page={{ blog_posts.next_page_number }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&amp;{{ key }}={{ value }}{% endifnotequal %}{% endfor %}" class="next"><span>Next page</span></a>
        </div>
    {% endif %}
</div> -->

<ul class="blogpage-listing">
{% for post in blog_posts %}
    <li class="blue">
        <a class="block-link" href="{% pageurl post %}">
            <div class="content">
                <div class="image-container">
                    <img src="" alt="">
                </div>
                <div class="blog-text">
    <!--                 {% if post.intro %}
                        {{ post.intro|richtext }}
                    {% endif %} -->
                    <div class="author">
                        {% with post.related_author.all as authors %}
                            {% if authors %}
                                {% for author in authors %}
                                    <div class="author-image">
                                        {% if author.author.image %}
                                        {% image author.author.image fill-300x300 as photo %}
                                        <img src="{{ photo.url }}" width="{{ photo.width }}" height="{{ photo.height }}" alt="{{ photo.alt }}" class="avatar"/>
                                        {% endif %}
                                    </div>
                                {% endfor %}
                            {% endif %}

                            <h3>{{ post.title }}</h3>

                            {% if post.related_author.all %}
                                {% for author in post.related_author.all %}
                                    <div class="name">{{ author.author.title }}</div>
                                {% endfor %}
                            {% endif %}

                            {% if post.date %}
                                <span class="date">{{ post.date|date:"j F Y" }}</span>
                            {% endif %}

                        {% endwith %}

                    </div>

                </div>

            </div>
        </a>
    </li>
{% endfor %}
</ul>

<div class="container pagination">
    {# Pagination #}

    {# Append any other url query string variables to the next and previous links - allows tag to be passed through #}
    <div class="previous">
        {% if blog_posts.has_previous %}
            <a href="?page={{ works.previous_page_number }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&amp;{{ key }}={{ value }}{% endifnotequal %}{% endfor %}"><p> Previous &nbsp;</p></a>
        {% endif %}
    </div>

    <div class="number">
        <p>{{ blog_posts.number }} of {{ blog_posts.paginator.num_pages }} </p>
    </div>

    <div class="next">
        {% if blog_posts.has_next %}
            <a href="?page={{ works.next_page_number }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&amp;{{ key }}={{ value }}{% endifnotequal %}{% endfor %}"><p> Next </p></a>
        {% endif %}
    </div>
</div>

<script type="text/javascript">
        {% if blog_posts.has_next %}
            var next_params = 'page=' + {{ blog_posts.next_page_number }};
        {% endif %}
        {% if blog_posts.has_previous %}
            var prev_params = 'page=' + {{ blog_posts.previous_page_number }};
        {% endif %}
        //var this_page = {{ blog_posts.number }}
</script>
